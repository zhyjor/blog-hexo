---
title: 浏览器的兼容性问题解决方案
tags:
  - 浏览器
  - 浏览器兼容性
categories: 浏览器
copyright: true
date: 2018-04-04 09:08:09
---

所谓浏览器兼容性问题指的是不同的浏览器对同一段代码不同的解析，造成页面显示效果不统一的情况。而我们想要的是无论用户使用什么浏览器打开我们的网站，都应该显示的是统一的效果，兼容性问题是前端开发必须要考虑的问题。
<!--more-->

## 属性
### vw属性
IE8不支持，啦啦啦
### float
ie6，ie7不兼容，但是还是有问题
### overflow
overflow:hidden 的 BFC 特性从 IE7 浏览器开始就支持

深入探讨一下 overflow 属性的一个很经典的不兼容问题，即 Chrome 浏览器下，如果容器可滚动（假设是垂直滚动），则 padding-bottom 也算在滚动尺寸之内， IE 和 Firefox 浏览器忽略 padding-bottom。

所以我们在实际项目开发的时候，要尽量避免滚动容器设置 padding-bottom 值，除了样式表现不一致外，还会导致 scrollHeight 值不一样，这往往会给开发带来难以察觉的麻烦，需要引起注意。

自 IE8 以上版本的浏览器开始， overflow 属性家族增加了两个属性，就是这里的 overflow-x和 overflow-y，分别表示单独控制水平或垂直方向上的剪裁规则。永远不可能实现一个方向溢出剪裁或滚动，另一方向内容溢出显示的效果。

HTML 中有两个标签是默认可以产生滚动条的，一个是根元素<html>，另一个是文本域`<textarea>`。之所以可以出现滚动条，**是因为这两个标签默认的 overflow 属性值不是visible，从 IE8 浏览器开始，都使用 auto 作为默认的属性值**。这也就意味着，从 IE8 浏览器开始，默认状态下是没有滚动栏的，尺寸溢出才会出现，对于 IE7 浏览器，其样式表现就好像设置了 overflow-y:scroll 一般。

Windows 7 系统下的测试和对比发现， IE7 及以上版本 IE、Chrome、 Firefox浏览器滚动栏所占据的宽度均是17px， 注意， 很精准的是17px,
当然，随着以后操作系统的升级，滚动栏的宽度发生变化也是有可能的。
```
// 获取浏览器滚动栏的宽度

.box { width: 400px; overflow: scroll; }

<div class="box">
	<div id="in" class="in"></div>
</div>

console.log(400 - document.getElementById("in").clientWidth);
```

而 HTML 内容是自上而下加载的，就会发生一开始没有滚动条，后来突然出现滚动条的情况，此时页面的可用宽度发生变化，水平居中重新计算，导致页面发生晃动，这个体验是非常不好的。这里分享一个可以让页面滚动条不发生晃动的小技巧，即使用如下 CSS 代码：

```css
html {
	overflow-y: scroll; /* for IE8 */
}
:root {
	overflow-y: auto;
	overflow-x: hidden;
}
:root body {
	position: absolute;
}
body {
	width: 100vw;
	overflow: hidden;
}
```




### display:inline-block 
IE6 和 IE7 浏览器下， block 水平的元素设置 display:inline-block 元素还是 block 水平，也就是还是会自适应容器的可用宽度显示。于是，对于 IE6 和 IE7 浏览器，我们会阴差阳错得到一个比overflow:hidden 更强大的声明，既 BFC 特性加身，又流体特性保留。*zoom: 1 也是类似效果，不过只适用于低级的 IE 浏览器，如 IE7。

### line-height 都是有差异
不同系统不同浏览器的默认 line-height 都是有差异，因此，在实际开发的时候，对 line-height 的默认值进行重置是势在必行的。

### display:table-cell
其让元素表现得像单元格一样， IE8 及以上版本浏览器才支持。

### 伪元素
ie7不支持

### rgba属性 
ie8不支持rgba属性，只能通过半透明图或者使用ie的渐变滤镜实现

### 内联元素的absolute包含块
但是根据我的测试，在 IE8 至 IE10 浏览器下，图片完全在<p>容器的左侧外部显示了， IE Edge 中则无此问题。需要给空的<span>元素设置 border 或 padding 让“幽灵空白节点”显现或者直接插入字符才能表现一致。

跨行的兼容性问题在于规范对此行为并未定义，导致浏览器在实现上各有差异。主要差异在于， Firefox 浏览器的“包含块”仅覆盖第一行，而 IE 和 Chrome 浏览器“包含块”的表现完全符合定义，由第一行开头和最后一行结尾的内联盒子共同决定。

### placeholder
IE9 及其以下浏览器不支持 placeholder 占位符效果，实际开发的时候，针对这些浏览
器，需要进行模拟。

### absolute
IE7 浏览器下，块状的`<div>`“无依赖绝对定位”的定位表现如同内联的`<span>`，也就是无论是块级元素还是内联元素，“无依赖绝对定位”后都和内联元素一行显示。

绝对定位元素的这种流体自适应特性从 IE7 就开始支持了很多同行依然使用下面这样的写法：
```css
// 没必要的
.box {
	position: absolute;
	left: 0; top: 0;
	width: 100%; height: 100%;
}
```

### color:transparent 
因为原生 IE8 浏览器并不支持它

### form

submit 类型按钮在IE7 下有黑框，很难所有浏览器（包括 Firefox 在内的浏览器） UI 完全一致，对视觉呈现是个一挑战。

```html
<form>
	<input type="submit" id="someID" class="clip">
	<label for="someID">提交</label>
</form>
```

### clip
至少在 Chrome 浏览器下， clip 仅仅是决定了哪一部分是可见的，对于原来占据的空间并无影响。然而，并不是所有浏览器都这么认为，在 IE 和 Firefox浏览器下是没有滚动条的，只有光秃秃的一小撮背景色在那里。这又是“未定义行为”的表现，看起来 IE 和 Firefox 对于 clip 渲染采用的是另外的方式。


但是无论怎样，下面这些特性大家的认识都是一致的：使用 clip 进行剪裁的元素其clientWidth 和 clientHeight 包括样式计算的宽高都还是原来的大小，从这一点看，Chrome的渲染似乎更合理。**虽然尺寸还是原来的尺寸**，但是，隐藏的区域是无法影响我们的点击行为的，说明 clip 隐藏还是很干脆的。

###  height 百分比值
子元素的 height 百分比值可以生效了（ IE8 及以上版本浏览器），所以高度自适应、高度等比例布局等效果都可以从容实现了。


### margin:auto
绝对定位元素 margin:auto 居中从 IE8 浏览器开始支持，而普通元素的 margin:auto 居中很早就支持了

### z-index
IE6 和 IE7 浏览器有个 bug，就是 z-index:auto 的定位元素也会创建层叠上下文。这就是过去 IE6 和 IE7 的 z-index 会折腾死人的原因。

在过去， position:fixed 和 relative/ absolute在层叠上下文这一块是一样的，都是需要 z-index 为数值才行。但是，不知道什么时候起，Chrome 等 WebKit 内核浏览器下，position:fixed 元素天然层叠上下文元素， 无须 z-index为数值。根据我的测试，目前 IE 和 Firefox 仍是老套路。


## 不同浏览器的特点与兼容性

### -webkit-私有前缀
滚动条是可以自定义的。因为 IE 浏览器的自定义效果实在是比原生的还要难看，就不浪费大家时间了，就此打住。倒是支持-webkit-前缀的浏览器可以说说。

对-webkit-私有前缀支持良好的浏览器还可以实现多行文字打点效果，但是却无须依赖 overflow:hidden。
```js
.ell-rows-2 {
	display: -webkit-box;
	-webkit-box-orient: vertical;
	-webkit-line-clamp: 2;
}
```


## pc端和移动端的不同

### scrollTop
注意，上述规则只对 PC 端有效，对于移动端并不一定适用。例如，在 PC 端，对`<html>`标签设置 overflow:hidden 可以隐藏滚动条禁止滚动，但是在移动端基本上无效。在 PC 端，窗体滚动高度可以使用 document.documentElement.scrollTop 获取，但是在移动端，可能就要使用 document.body.scrollTop 获取。





**参考资料**
[浏览器兼容性问题及解决方法](https://www.jianshu.com/c/422a8d74681a)
[浏览器兼容性问题解决方案 · 总结](https://juejin.im/post/59a3f2fe6fb9a0249471cbb4)
[再谈ie浏览器兼容问题](http://jartto.wang/2016/12/06/talk-about-ie-compatible-over-again/)


![](http://oankigr4l.bkt.clouddn.com/wexin.png)